<!--index.wxml-->
<view class="container">
  <view class="page__hd">
    <view class="page__title">{{currentDateStr}}</view>
    <view class="page__desc">{{type.label}}</view>
  </view>
  <view class="page__bd">
    <mp-form>
      <view wx:if="{{loaded}}">
        <mp-cells title="状况" wx:if="{{showWeight || showDefecation}}">
          <mp-cell title="体重 (kg)" wx:if="{{showWeight}}">
            <input type="number" value="{{weight}}" class="weui-input" placeholder="请输入数字" bindinput="onWeightChange"/>
          </mp-cell>
          <mp-cell title="排便次数" wx:if="{{showDefecation}}">
            <input type="number" value="{{defecation}}" class="weui-input" placeholder="请输入数字" bindinput="onDefecationChange"/>
          </mp-cell>
        </mp-cells>
      </view>

      <view wx:if="{{loaded}}">
        <view class="weui-cells__title" wx:if="{{showWeight || showDefecation}}">其他</view>
        <view class="weui-cells weui-cells_after-title">
          <view class="weui-cell">
            <view class="weui-cell__bd">
              <view wx:if="{{isReview}}" class="review-text">{{value ? value : '请选择...'}}</view>
              <textarea wx:else value="{{value}}" auto-height class="weui-textarea"
                        placeholder="多条记录请用换行分隔" name="record" bindinput="onChange"
                        bindconfirm="doSave"/>
            </view>
          </view>
        </view>
      </view>

      <view wx:if="{{recent.length > 0 && loaded}}">
        <view class="weui-cells__title">最近使用</view>
        <view class="recent-view">
          <button wx:for="{{recent}}" wx:key="item" hover-class="recent-item-hover"
                  class="weui-btn mini-btn recent-item"
                  type="default" size="mini" data-value="{{item}}" bindtap="onRecentClick"
                  bindlongpress="onRecentDelete">
            <text>{{item}}</text>
          </button>
        </view>
      </view>
      <view class="weui-btn-area">
        <button class="weui-btn" type="primary" wx:if="{{isReview}}">
          <picker bindchange="onScdFoodChange" range="{{scdFoods}}">
            添加...
          </picker>
        </button>
        <button class="weui-btn" type="primary" bindtap="doSave">保存</button>
        <button wx:if="{{record && value}}" class="weui-btn" type="warn" bindtap="deleteRecord">删除</button>
      </view>
    </mp-form>
  </view>
</view>
